<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab3 â€¢ DBSStats2Labs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab3">
<meta property="og:description" content="DBSStats2Labs">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DBSStats2Labs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/About.html">About</a>
    </li>
    <li>
      <a href="../articles/Lab1.html">Lab1</a>
    </li>
    <li>
      <a href="../articles/Lab2.html">Lab2</a>
    </li>
    <li>
      <a href="../articles/Lab3.html">Lab3</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab3</h1>
            
      
      
      <div class="hidden name"><code>Lab3.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DBSStats2Labs</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  Today's lab will pertain to multiple regression, orthogonal and non-orthogonal.</span></code></pre></div>
<div class="section level4">
<h4 id="typing-manually-as-opposed-to-copy-pasting-helps-me-remember-code-better--this-webpage-will-be-split-into-parts-1-the-assignment-itself-and-2-following-along-with-the-exercises-">Typing manually (as opposed to copy-pasting) helps me remember code better. This webpage will be split into parts 1 (the assignment itself) and 2 (following along with the exercises).<a class="anchor" aria-label="anchor" href="#typing-manually-as-opposed-to-copy-pasting-helps-me-remember-code-better--this-webpage-will-be-split-into-parts-1-the-assignment-itself-and-2-following-along-with-the-exercises-"></a>
</h4>
</div>
<div class="section level2">
<h2 id="part-1-generalization-assignment">PART 1: Generalization Assignment<a class="anchor" aria-label="anchor" href="#part-1-generalization-assignment"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#NOTE: Because I'm not quite brilliant enough to creatively think of tutorial tips 100% on my own, I had to consult some online discourse. The links to these web-pages are provided below. Matt- please let me know if this was an acceptable choice. </span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#When conducting multiple regression analyses, it is crucial that all predictor variables are</span>
<span class="co">#orthogonal. The "geometric" basis for this concept may obfuscate the straightforwardness of</span>
<span class="co">#this concept: each predictor should be independent from one another, avoid predicting changes </span>
<span class="co">#in other predictor variables, and should hold an independent predictive "influence" over the </span>
<span class="co">#dependent variables. In other words- if any predictor varies alongside another, their shared</span>
<span class="co">#influence over the DV would confound one another. For example, if "height" and "age" were both</span>
<span class="co">#assessed as predictive variables for the DV "joint health," the principle of orthogonality would</span>
<span class="co">#be inherently violated since height and age could both be reasonably hypothesized as holding a </span>
<span class="co">#relationship with joint health- and because height would also be expected to covary with age.</span>
<span class="co">#Any unique influence of height on joint health, for example, might accidentally be confounded </span>
<span class="co">#by the non-orthogonal influence of age on height and consequently joint health as well.</span>

<span class="co">#Taken at face value, checking for orthogonality between two variables is extremely simple.</span>
<span class="co">#Because non-orthogonal predictor variables would co-vary with one another, it is reasonable</span>
<span class="co">#to deduce that they should correlate with one another as well. Let's flesh out this age/height/</span>
<span class="co">#joint-health example with some fake data assuming 18 subjects (and some arbitrary "joint health" metric):</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">21</span>, <span class="fl">23</span>, <span class="fl">26</span>, <span class="fl">29</span>, <span class="fl">32</span>, <span class="fl">41</span>, <span class="fl">48</span>, <span class="fl">52</span>, <span class="fl">59</span>, <span class="fl">66</span>, <span class="fl">74</span><span class="op">)</span>
<span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">4.8</span>, <span class="fl">4.7</span>, <span class="fl">5.3</span>, <span class="fl">5.5</span>, <span class="fl">6</span>, <span class="fl">5.9</span>, <span class="fl">6.2</span>, <span class="fl">5.5</span>, <span class="fl">6.3</span>, <span class="fl">5.6</span>, <span class="fl">5.8</span>, <span class="fl">5.6</span>, <span class="fl">6.2</span>, <span class="fl">4.9</span>, <span class="fl">5.7</span>, <span class="fl">6.1</span>, <span class="fl">5.9</span><span class="op">)</span>
<span class="va">joint_health_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">joint_health_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="va">age</span>,
                            Height <span class="op">=</span> <span class="va">height</span>,
                            JHI <span class="op">=</span> <span class="va">joint_health_index</span><span class="op">)</span>

<span class="co">#We can effectively check for orthogonality by assessing whether age and height are correlated with one another, using a simple cor expression.</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">joint_health_data</span><span class="op">)</span>
<span class="co">#                Age     Height        JHI</span>
<span class="co">#  Age     1.0000000  0.4052203 -0.7520185</span>
<span class="co">#  Height  0.4052203  1.0000000 -0.4203486</span>
<span class="co">#  JHI    -0.7520185 -0.4203486  1.0000000</span>

<span class="co">#It is apparent from this correlation matrix that age and height have a correlation of 0.40. Now what about the R^2 values?</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">joint_health_data</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#               Age    Height       JHI</span>
<span class="co">#  Age    1.0000000 0.1642035 0.5655318</span>
<span class="co">#  Height 0.1642035 1.0000000 0.1766930</span>
<span class="co">#  JHI    0.5655318 0.1766930 1.0000000</span>

<span class="co">#Thus, 16.4% of variation in either the age or height variables can explain variation in height or age, respectively. They are therefore liable to confound one another in regression analyses for their ability to predict variance in joint health. </span>

<span class="co">#There are methods to correct for non-orthogonality such as this, however that is not the focus of the present tutorial. Instead, it is my desire to point out that manually checking correlation matrices is a relatively indirect and (debatably) inefficient way to probe for orthogonality in one's data-set. Let's talk about one other method to check orthogonality. We must install and load the "ibd" package, and our data must be in matrix format if it is not already. We can then use the "check.orthogonality" function.</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">joint_health_data</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ibd"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span>
<span class="co">#  Installing package into 'C:/Users/m3gad/AppData/Local/Temp/Rtmp6TYvlZ/temp_libpath489014e81152'</span>
<span class="co">#  (as 'lib' is unspecified)</span>
<span class="co">#  package 'ibd' successfully unpacked and MD5 sums checked</span>
<span class="co">#  </span>
<span class="co">#  The downloaded binary packages are in</span>
<span class="co">#   C:\Users\m3gad\AppData\Local\Temp\RtmpKYLlvb\downloaded_packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ibd</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ibd/man/check.orthogonality.html" class="external-link">check.orthogonality</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#  [1] 0</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#This function is very simple. If the function returns a "1," the rows are orthogonal. If it returns "0," they are not. The limitation to this function is that it only checks whether ROWS are PAIRWISE orthogonal or not. The result returned of "0" reaffirms our earlier checking of correlation matrices, which also indicated that the variables are not orthogonal. </span>

<span class="co">#Matt: I honestly worry that I either misunderstood this function, or that my data is not in the correct format for row-based pairwise orthogonality testing. I admit that I'm only just scratching the surface with this, but I hope this "tutorial" sets out what it was meant to do. </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#WEBPAGES REFERENCED FOR THIS DOCUMENTATION:</span>
<span class="co"># https://www.rdocumentation.org/packages/ibd/versions/1.5/topics/check.orthogonality</span>
<span class="co"># https://rdrr.io/cran/ibd/man/check.orthogonality.html</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="part-2-follow-along-with-lab-demonstration">PART 2: Follow-along with lab demonstration<a class="anchor" aria-label="anchor" href="#part-2-follow-along-with-lab-demonstration"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Explaining variance using multiple variables</span>
<span class="va">random_vectors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">*</span><span class="fl">26</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">20</span>, ncol <span class="op">=</span> <span class="fl">26</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">random_vectors</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span>
<span class="va">random_vectors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">random_vectors</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Lab3_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span>, data <span class="op">=</span> <span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  </span>
<span class="co">#  Call:</span>
<span class="co">#  lm(formula = a ~ b, data = random_vectors)</span>
<span class="co">#  </span>
<span class="co">#  Residuals:</span>
<span class="co">#       Min       1Q   Median       3Q      Max </span>
<span class="co">#  -1.61756 -0.64576 -0.09556  0.68313  1.78080 </span>
<span class="co">#  </span>
<span class="co">#  Coefficients:</span>
<span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#  (Intercept)  -0.1494     0.2115  -0.706    0.489</span>
<span class="co">#  b            -0.2978     0.2437  -1.222    0.238</span>
<span class="co">#  </span>
<span class="co">#  Residual standard error: 0.943 on 18 degrees of freedom</span>
<span class="co">#  Multiple R-squared:  0.07659,    Adjusted R-squared:  0.02529 </span>
<span class="co">#  F-statistic: 1.493 on 1 and 18 DF,  p-value: 0.2375</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.07658646</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.07658646</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1065886</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1284398</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span><span class="op">+</span><span class="va">e</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1322264</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span><span class="op">+</span><span class="va">e</span><span class="op">+</span><span class="va">f</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1325428</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span><span class="op">+</span><span class="va">e</span><span class="op">+</span><span class="va">f</span><span class="op">+</span><span class="va">g</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1490741</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">+</span><span class="va">c</span><span class="op">+</span><span class="va">d</span><span class="op">+</span><span class="va">e</span><span class="op">+</span><span class="va">f</span><span class="op">+</span><span class="va">g</span><span class="op">+</span><span class="va">h</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1714482</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.1734893</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.2462433</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span><span class="op">*</span><span class="va">e</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 0.6552117</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span><span class="op">*</span><span class="va">e</span><span class="op">*</span><span class="va">f</span>,data<span class="op">=</span><span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>
<span class="co">#  [1] 1</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span><span class="op">*</span><span class="va">e</span>, data <span class="op">=</span> <span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  </span>
<span class="co">#  Call:</span>
<span class="co">#  lm(formula = a ~ b * c * d * e, data = random_vectors)</span>
<span class="co">#  </span>
<span class="co">#  Residuals:</span>
<span class="co">#         1        2        3        4        5        6        7        8 </span>
<span class="co">#  -0.21681  0.33838  0.41071  0.63302  0.93964 -0.57523  0.09133 -0.11465 </span>
<span class="co">#         9       10       11       12       13       14       15       16 </span>
<span class="co">#   0.32138 -0.92367  0.64265 -0.24068 -0.97536  0.23922  0.31091  0.08281 </span>
<span class="co">#        17       18       19       20 </span>
<span class="co">#  -0.92294 -0.63101  0.14167  0.44864 </span>
<span class="co">#  </span>
<span class="co">#  Coefficients:</span>
<span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#  (Intercept) -1.21053    0.77428  -1.563    0.193</span>
<span class="co">#  b           -1.01395    1.24593  -0.814    0.461</span>
<span class="co">#  c            0.20400    1.03490   0.197    0.853</span>
<span class="co">#  d            0.00836    0.75162   0.011    0.992</span>
<span class="co">#  e            0.29315    0.70327   0.417    0.698</span>
<span class="co">#  b:c         -1.82152    1.51242  -1.204    0.295</span>
<span class="co">#  b:d         -0.76402    1.57339  -0.486    0.653</span>
<span class="co">#  c:d          1.16845    0.88543   1.320    0.257</span>
<span class="co">#  b:e          1.50429    1.57548   0.955    0.394</span>
<span class="co">#  c:e          2.07180    2.04277   1.014    0.368</span>
<span class="co">#  d:e          1.45582    1.69785   0.857    0.440</span>
<span class="co">#  b:c:d       -0.89697    1.68991  -0.531    0.624</span>
<span class="co">#  b:c:e        1.62887    2.74839   0.593    0.585</span>
<span class="co">#  b:d:e       -1.19308    2.72668  -0.438    0.684</span>
<span class="co">#  c:d:e       -4.49468    3.47577  -1.293    0.266</span>
<span class="co">#  b:c:d:e     -1.84584    6.17221  -0.299    0.780</span>
<span class="co">#  </span>
<span class="co">#  Residual standard error: 1.222 on 4 degrees of freedom</span>
<span class="co">#  Multiple R-squared:  0.6552, Adjusted R-squared:  -0.6377 </span>
<span class="co">#  F-statistic: 0.5068 on 15 and 4 DF,  p-value: 0.8495</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">a</span><span class="op">~</span><span class="va">b</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">d</span><span class="op">*</span><span class="va">e</span><span class="op">*</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">random_vectors</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  </span>
<span class="co">#  Call:</span>
<span class="co">#  lm(formula = a ~ b * c * d * e * f, data = random_vectors)</span>
<span class="co">#  </span>
<span class="co">#  Residuals:</span>
<span class="co">#  ALL 20 residuals are 0: no residual degrees of freedom!</span>
<span class="co">#  </span>
<span class="co">#  Coefficients: (12 not defined because of singularities)</span>
<span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="co">#  (Intercept)  -0.7091        NaN     NaN      NaN</span>
<span class="co">#  b             0.7948        NaN     NaN      NaN</span>
<span class="co">#  c             0.3642        NaN     NaN      NaN</span>
<span class="co">#  d            -0.8559        NaN     NaN      NaN</span>
<span class="co">#  e             0.5171        NaN     NaN      NaN</span>
<span class="co">#  f             0.4180        NaN     NaN      NaN</span>
<span class="co">#  b:c           0.4801        NaN     NaN      NaN</span>
<span class="co">#  b:d          -2.5330        NaN     NaN      NaN</span>
<span class="co">#  c:d          -0.7906        NaN     NaN      NaN</span>
<span class="co">#  b:e          -0.2991        NaN     NaN      NaN</span>
<span class="co">#  c:e          -1.2985        NaN     NaN      NaN</span>
<span class="co">#  d:e           1.2673        NaN     NaN      NaN</span>
<span class="co">#  b:f          -1.1740        NaN     NaN      NaN</span>
<span class="co">#  c:f           0.8380        NaN     NaN      NaN</span>
<span class="co">#  d:f           2.6564        NaN     NaN      NaN</span>
<span class="co">#  e:f          -1.9627        NaN     NaN      NaN</span>
<span class="co">#  b:c:d        -1.8047        NaN     NaN      NaN</span>
<span class="co">#  b:c:e        -3.8385        NaN     NaN      NaN</span>
<span class="co">#  b:d:e         0.7471        NaN     NaN      NaN</span>
<span class="co">#  c:d:e         0.1472        NaN     NaN      NaN</span>
<span class="co">#  b:c:f             NA         NA      NA       NA</span>
<span class="co">#  b:d:f             NA         NA      NA       NA</span>
<span class="co">#  c:d:f             NA         NA      NA       NA</span>
<span class="co">#  b:e:f             NA         NA      NA       NA</span>
<span class="co">#  c:e:f             NA         NA      NA       NA</span>
<span class="co">#  d:e:f             NA         NA      NA       NA</span>
<span class="co">#  b:c:d:e           NA         NA      NA       NA</span>
<span class="co">#  b:c:d:f           NA         NA      NA       NA</span>
<span class="co">#  b:c:e:f           NA         NA      NA       NA</span>
<span class="co">#  b:d:e:f           NA         NA      NA       NA</span>
<span class="co">#  c:d:e:f           NA         NA      NA       NA</span>
<span class="co">#  b:c:d:e:f         NA         NA      NA       NA</span>
<span class="co">#  </span>
<span class="co">#  Residual standard error: NaN on 0 degrees of freedom</span>
<span class="co">#  Multiple R-squared:      1,  Adjusted R-squared:    NaN </span>
<span class="co">#  F-statistic:   NaN on 19 and 0 DF,  p-value: NA</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>

<span class="va">slamecka_design</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">Subjects</span>, <span class="op">~</span><span class="va">OL</span>, <span class="op">~</span><span class="va">IL</span>,
  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">0</span>,
  <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">4</span>,
  <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">8</span>,
  <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">0</span>,
  <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>,
  <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">8</span>,
  <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">4</span>,
  <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">0</span>,
  <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">8</span>,
  <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">0</span>,
  <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">4</span>,
  <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">8</span>,
  <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">8</span>,
  <span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">0</span>,
  <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">4</span>,
  <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">8</span>,
  <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">4</span>,
  <span class="fl">8</span>, <span class="fl">8</span>, <span class="fl">0</span>,
  <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">9</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">9</span>, <span class="fl">2</span>, <span class="fl">0</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">slamecka_design</span><span class="op">)</span>
<span class="co">#           Subjects OL IL</span>
<span class="co">#  Subjects        1  0  0</span>
<span class="co">#  OL              0  1  0</span>
<span class="co">#  IL              0  0  1</span>

<span class="va">slamecka_confounded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
  <span class="op">~</span><span class="va">Subjects</span>, <span class="op">~</span><span class="va">OL</span>, <span class="op">~</span><span class="va">IL</span>,
  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">1</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">6</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">0</span>,
  <span class="fl">8</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">8</span>,
  <span class="fl">9</span>, <span class="fl">4</span>, <span class="fl">4</span>,
  <span class="fl">9</span>, <span class="fl">2</span>, <span class="fl">0</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">slamecka_confounded</span><span class="op">)</span>
<span class="co">#           Subjects        OL        IL</span>
<span class="co">#  Subjects        1 0.0000000 0.0000000</span>
<span class="co">#  OL              0 1.0000000 0.9819805</span>
<span class="co">#  IL              0 0.9819805 1.0000000</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#  </span>
<span class="co">#  Attaching package: 'dplyr'</span>
<span class="co">#  The following objects are masked from 'package:stats':</span>
<span class="co">#  </span>
<span class="co">#      filter, lag</span>
<span class="co">#  The following objects are masked from 'package:base':</span>
<span class="co">#  </span>
<span class="co">#      intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<p>#Hulme et al (1984) example</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,
               T <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,
               Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">23</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">39</span>, <span class="fl">67</span><span class="op">)</span><span class="op">)</span>

<span class="op">(</span><span class="va">overall_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span><span class="op">+</span><span class="cn">T</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#  </span>
<span class="co">#  Call:</span>
<span class="co">#  lm(formula = Y ~ X + T, data = data)</span>
<span class="co">#  </span>
<span class="co">#  Residuals:</span>
<span class="co">#       1      2      3      4      5      6 </span>
<span class="co">#  -1.167 -1.667  2.333  3.333 -1.167 -1.667 </span>
<span class="co">#  </span>
<span class="co">#  Coefficients:</span>
<span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)   </span>
<span class="co">#  (Intercept)    1.667      3.598   0.463  0.67470   </span>
<span class="co">#  X              1.000      0.725   1.379  0.26162   </span>
<span class="co">#  T              9.500      1.087   8.736  0.00316 **</span>
<span class="co">#  ---</span>
<span class="co">#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#  </span>
<span class="co">#  Residual standard error: 2.877 on 3 degrees of freedom</span>
<span class="co">#  Multiple R-squared:  0.9866, Adjusted R-squared:  0.9776 </span>
<span class="co">#  F-statistic: 110.1 on 2 and 3 DF,  p-value: 0.001559</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#            X         T         Y</span>
<span class="co">#  X 1.0000000 0.7500000 0.8027961</span>
<span class="co">#  T 0.7500000 1.0000000 0.9889517</span>
<span class="co">#  Y 0.8027961 0.9889517 1.0000000</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#            X         T         Y</span>
<span class="co">#  X 1.0000000 0.5625000 0.6444815</span>
<span class="co">#  T 0.5625000 1.0000000 0.9780254</span>
<span class="co">#  Y 0.6444815 0.9780254 1.0000000</span>

<span class="va">lm.x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>X_residuals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.x</span><span class="op">)</span>,
         X_predicted_Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm.x</span><span class="op">)</span><span class="op">)</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">X</th>
<th align="right">T</th>
<th align="right">Y</th>
<th align="right">X_residuals</th>
<th align="right">X_predicted_Y</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">14</td>
<td align="right">-5.916667</td>
<td align="right">19.91667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">23</td>
<td align="right">3.083333</td>
<td align="right">19.91667</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">30</td>
<td align="right">-7.166667</td>
<td align="right">37.16667</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">4</td>
<td align="right">50</td>
<td align="right">12.833333</td>
<td align="right">37.16667</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">3</td>
<td align="right">39</td>
<td align="right">-15.416667</td>
<td align="right">54.41667</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">6</td>
<td align="right">67</td>
<td align="right">12.583333</td>
<td align="right">54.41667</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y</span>, x<span class="op">=</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">X_predicted_Y</span>, x<span class="op">=</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">X_residuals</span>, x<span class="op">=</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"patchwork"</span>, repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span>
<span class="co">#  Installing package into 'C:/Users/m3gad/AppData/Local/Temp/Rtmp6TYvlZ/temp_libpath489014e81152'</span>
<span class="co">#  (as 'lib' is unspecified)</span>
<span class="co">#  package 'patchwork' successfully unpacked and MD5 sums checked</span>
<span class="co">#  </span>
<span class="co">#  The downloaded binary packages are in</span>
<span class="co">#   C:\Users\m3gad\AppData\Local\Temp\RtmpKYLlvb\downloaded_packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>

<span class="va">A</span><span class="op">+</span><span class="va">B</span><span class="op">+</span><span class="va">C</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="Lab3_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lm.t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="cn">T</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>T_residuals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.t</span><span class="op">)</span>,
         T_predicted_Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lm.t</span><span class="op">)</span><span class="op">)</span>
<span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">Y</span>, x<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="va">E</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">T_predicted_Y</span>, x<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="cn">F</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">T_residuals</span>, x<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"lm"</span>,se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="va">D</span><span class="op">+</span><span class="va">E</span><span class="op">+</span><span class="cn">F</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span>
<span class="co">#  `geom_smooth()` using formula 'y ~ x'</span></code></pre></div>
<p><img src="Lab3_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lm.xt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">X</span><span class="op">~</span><span class="cn">T</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.xt</span><span class="op">)</span>
<span class="co">#       1      2      3      4      5      6 </span>
<span class="co">#  -0.750 -1.875  1.125 -1.125  3.000 -0.375</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.xt</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#  [1] 0.008528111</span>

<span class="va">lm.tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="cn">T</span><span class="op">~</span><span class="va">X</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.tx</span><span class="op">)</span>
<span class="co">#     1    2    3    4    5    6 </span>
<span class="co">#  -0.5  0.5 -1.0  1.0 -1.5  1.5</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.tx</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#  [1] 0.342072</span>

<span class="va">overall_model</span><span class="op">$</span><span class="va">r.squared</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.xt</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">lm.tx</span><span class="op">)</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#  [1] 0.6359534</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ppcor</span><span class="op">)</span>
<span class="co">#  Loading required package: MASS</span>
<span class="co">#  </span>
<span class="co">#  Attaching package: 'MASS'</span>
<span class="co">#  The following object is masked from 'package:patchwork':</span>
<span class="co">#  </span>
<span class="co">#      area</span>
<span class="co">#  The following object is masked from 'package:dplyr':</span>
<span class="co">#  </span>
<span class="co">#      select</span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,
               T <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,
               Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">23</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">39</span>, <span class="fl">67</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ppcor/man/spcor.html" class="external-link">spcor</a></span><span class="op">(</span><span class="va">data</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span>
<span class="co">#  $estimate</span>
<span class="co">#              X          T         Y</span>
<span class="co">#  X  1.00000000 -0.2963241 0.4120552</span>
<span class="co">#  T -0.07367089  1.0000000 0.6488088</span>
<span class="co">#  Y  0.09234777  0.5848692 1.0000000</span>
<span class="co">#  </span>
<span class="co">#  $p.value</span>
<span class="co">#            X         T         Y</span>
<span class="co">#  X 0.0000000 0.6283051 0.4906046</span>
<span class="co">#  T 0.9062842 0.0000000 0.2362282</span>
<span class="co">#  Y 0.8825865 0.3002769 0.0000000</span>
<span class="co">#  </span>
<span class="co">#  $statistic</span>
<span class="co">#             X          T         Y</span>
<span class="co">#  X  0.0000000 -0.5373837 0.7832889</span>
<span class="co">#  T -0.1279494  0.0000000 1.4767956</span>
<span class="co">#  Y  0.1606375  1.2489073 0.0000000</span>
<span class="co">#  </span>
<span class="co">#  $n</span>
<span class="co">#  [1] 6</span>
<span class="co">#  </span>
<span class="co">#  $gp</span>
<span class="co">#  [1] 1</span>
<span class="co">#  </span>
<span class="co">#  $method</span>
<span class="co">#  [1] "pearson"</span>

<span class="fu"><a href="https://rdrr.io/pkg/ppcor/man/spcor.html" class="external-link">spcor</a></span><span class="op">(</span><span class="va">data</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">^</span><span class="fl">2</span>
<span class="co">#              X          T         Y</span>
<span class="co">#  X 1.000000000 0.08780798 0.1697895</span>
<span class="co">#  T 0.005427400 1.00000000 0.4209528</span>
<span class="co">#  Y 0.008528111 0.34207202 1.0000000</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
